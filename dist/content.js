function p(){const r=document.querySelector('input[aria-label="Title field"]')?.value?.trim()||"untitled-task",e=document.querySelector(".work-item-form-header a")?.textContent?.trim().toLowerCase()||"task",o=e.match(/(\d+)/),t=o?o[1]:"0000";let a="task";return e.includes("bug")?a="bug":e.includes("feature")?a="feature":e.includes("epic")?a="epic":e.includes("suggestion")?a="suggestion":e.includes("product")&&(a="product"),{type:a,id:t,title:r}}function h(r){switch(r.toLowerCase()){case"epic":return"epic";case"feature":return"feat";case"suggestion":return"suggestion";case"bug":return"fix";case"product":return"item";case"task":return"task";default:return"misc"}}function g(r){return r.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")}function y({type:r,id:n,title:e}){const o=h(r),t=g(e);return`${o}/TP-${n}-${t}`}function S({type:r,id:n,title:e}){const o=h(r),t=g(e).replace(/-/g," "),a=`${o}: ${t}`,i=`${o==="fix"?"Fixes":"Implements"}: #${n}`;return`${a}

${i}`}function x(r,n){const e={branch:n,savedAt:new Date().toISOString()};localStorage.setItem(`branchName-${r}`,JSON.stringify(e))}function v(r){try{return JSON.parse(localStorage.getItem(`branchName-${r}`))}catch{return null}}function d(r,n,e,o){const t=document.createElement("button");t.id=r,t.className="bolt-button bolt-icon-button enabled bolt-focus-treatment",t.setAttribute("role","button"),t.setAttribute("aria-label",e),t.style.cssText=`
    display: inline-flex;
    align-items: center;
    padding: 0px;
    font-size: 12px;
    background-color: transparent;
    width: min-content;
    transition: background-color 0.3s ease;
  `,t.addEventListener("mouseenter",()=>{t.style.backgroundColor="var(--palette-black-alpha-6,rgba(0, 0, 0, 0.06))"}),t.addEventListener("mouseleave",()=>{t.style.backgroundColor="transparent"});const a=document.createElement("span");a.className="fluent-icons-enabled";const i=document.createElement("span");return i.className=`left-icon flex-noshrink fabric-icon ${n} medium`,i.setAttribute("aria-hidden","true"),i.style.padding="0",a.appendChild(i),t.appendChild(a),t.onclick=o,t}function w(r){const n=document.createElement("button");return n.id="commit-copy-button",n.className="bolt-button bolt-default-button bolt-focus-treatment",n.style.cssText="margin-left: 10px; padding: 0px 6px; font-size: 12px;",n.innerText="Copy Commit Msg",n.onclick=()=>{const e=S(r);navigator.clipboard.writeText(e).then(()=>{const o=n.innerText;n.innerText="âœ“",setTimeout(()=>{n.innerText=o},5e3)})},n}function I(r){const n=new Intl.RelativeTimeFormat("en",{numeric:"auto"}),e=new Date,o=new Date(r),t=Math.round((o.getTime()-e.getTime())/1e3),a=[{limit:60,divisor:1,unit:"second"},{limit:3600,divisor:60,unit:"minute"},{limit:86400,divisor:3600,unit:"hour"},{limit:604800,divisor:86400,unit:"day"},{limit:2419200,divisor:604800,unit:"week"},{limit:29030400,divisor:2419200,unit:"month"},{limit:1/0,divisor:29030400,unit:"year"}],i=Math.abs(t);for(const c of a)if(i<c.limit){const s=Math.round(t/c.divisor);return n.format(s,c.unit)}return""}function l(r,n,e){const o=document.querySelector("#branch-name-inline");o&&o.remove();const t=document.querySelector(".work-item-form-header a");if(!t)return;const a=p(),i=$(r,n,e),c=w(a);i.appendChild(c),t.parentElement.appendChild(i)}function $(r,n,e){const o=document.createElement("div");o.id="branch-name-inline",o.style.cssText=`
    margin-left: 10px;
    font-family: monospace;
    font-size: 13px;
    display: flex;
    align-items: center;
    gap: 8px;
  `;const t=document.createElement("code");t.style.cssText=`
    height: 100%;
  `,t.textContent=r;const a=d("copy-branch-name-btn","ms-Icon--Copy","Copy branch name",()=>{navigator.clipboard.writeText(r).then(()=>{m()})}),i=d("regenerate-branch-name-btn","ms-Icon--Refresh","Regenerate branch name",()=>{const T=p(),u=y(T);x(n,u),o.remove(),l(u,n,new Date().toISOString()),navigator.clipboard.writeText(u).then(()=>{m()})}),c=d("delete-branch-name-btn","ms-Icon--Delete","Delete branch name",()=>{localStorage.removeItem(`branchName-${n}`),o.remove(),f(n)}),s=document.createElement("span");return s.style.cssText="font-size: 11px; color: #888;",s.textContent=`saved ${I(e)}`,o.appendChild(t),o.appendChild(a),o.appendChild(i),o.appendChild(c),o.appendChild(s),o}function f(r){const n=document.querySelector(".work-item-form-header a");if(!n||document.querySelector("#branch-name-generate"))return;const e=document.createElement("button");e.id="branch-name-generate",e.className="bolt-button bolt-default-button bolt-focus-treatment",e.style.cssText="margin-left: 10px; padding: 0px 6px; font-size: 12px;",e.innerText="Generate Branch Name",e.onclick=()=>{const o=p(),t=y(o),a=new Date().toISOString();x(r,t),l(t,r,a),navigator.clipboard.writeText(t).then(()=>{m()}),e.remove()},n.parentElement.appendChild(e)}function m(r=1500){const n=document.querySelector("#copy-branch-name-btn");if(!n)return;const e=n.querySelector(".ms-Icon--Copy");e&&(e.classList.replace("ms-Icon--Copy","ms-Icon--CheckMark"),setTimeout(()=>{e.classList.replace("ms-Icon--CheckMark","ms-Icon--Copy")},r))}function b(r=0){const n=document.querySelector('input[aria-label="Title field"]'),e=document.querySelector(".work-item-form-header a");if(n&&e){const o=e.textContent.match(/(\d+)/),t=o?o[1]:null;if(!t)return;const a=v(t);a?.branch&&a?.savedAt?l(a.branch,t,a.savedAt):f(t)}else r<10&&setTimeout(()=>b(r+1),500)}C();b();function C(){new MutationObserver(n=>{for(const e of n)for(const o of e.addedNodes)o.nodeType===1&&o.querySelector?.('input[aria-label="Title field"]')&&o.querySelector?.(".work-item-form-header a")&&b(0)}).observe(document.body,{childList:!0,subtree:!0})}function k(r=0){const n=document.querySelector('input[aria-label="Title field"]'),e=document.querySelector(".work-item-form-header a");if(n&&e){const o=e.textContent.match(/(\d+)/),t=o?o[1]:null;if(!t)return;const a=v(t);a?.branch&&a?.savedAt?l(a.branch,t,a.savedAt):f(t)}else r<10&&setTimeout(()=>k(r+1),500)}C();k();
